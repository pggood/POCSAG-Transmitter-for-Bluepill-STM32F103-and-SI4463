/*
 * radio_config_Si4463.h
 *
 *  Created on: Oct 20, 2025
 *      Author: peter
 */
#ifndef RADIO_CONFIG_SI4463_H
#define RADIO_CONFIG_SI4463_H

// Generated using Silicon Labs Wireless Development Suite (WDS)
// Configuration for 148.025 MHz, 2-FSK, 1200 bps, RX Bandwidth ~10 kHz
// Preamble: 20 bytes, Sync Word: 0x7CD215D8
// Modified for Wake-on-Radio operation with interrupt support
static const uint8_t RADIO_CONFIGURATION_DATA_ARRAY[] = {
    0x07, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 0x00, // POWER_UP

    // GPIO Configuration - GPIO1 as NIRQ output (active low)
    0x08, 0x11, 0x01, 0x06, 0x21, 0x00, 0x40, 0x18, 0x00, 0x00, // GPIO_PIN_CFG
    // GPIO1: 0x21 = NIRQ output, GPIO0: 0x00 = disabled, others default

    0x0C, 0x20, 0x00, 0x0B, 0x1C, 0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, // GLOBAL_CONFIG
    0x05, 0x21, 0x00, 0x02, 0x03, 0xE8,               // GLOBAL_XO_TUNE
    0x06, 0x30, 0x00, 0x03, 0x00, 0x07, 0xD0,        // MODEM_MOD_TYPE
    0x06, 0x31, 0x00, 0x03, 0x00, 0x09, 0x00,        // MODEM_FREQ_DEV
    0x05, 0x33, 0x00, 0x02, 0x00, 0x64,               // MODEM_TX_RAMP_DELAY
    0x07, 0x40, 0x00, 0x04, 0x00, 0x00, 0x00, 0x00,  // MODEM_AFC_CTRL
    0x0C, 0x44, 0x00, 0x0B, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, // MODEM_RSSI_CONTROL

    // Preamble Configuration - 20 bytes (160 bits) minimum for POCSAG
    0x05, 0x50, 0x00, 0x02, 0x00, 0x14,               // PREAMBLE_TX_LENGTH

    // Preamble detection configuration for wake-on-radio
    0x06, 0x51, 0x00, 0x04, 0x14, 0x00, 0x0F, 0x31,  // PREAMBLE_CONFIG
    // 0x14 = preamble timeout, 0x00 = standard preamble, 0x0F = detection threshold, 0x31 = enable detection

    // Sync Word Configuration - POCSAG sync word 0x7CD215D8
    0x09, 0x51, 0x04, 0x06, 0x7C, 0xD2, 0x15, 0xD8, 0x00, 0x00, // SYNC_CONFIG
    // First 4 bytes: sync word, last 2 bytes: sync word length and configuration

    // Interrupt Control - Enable preamble and sync word detection interrupts
    0x08, 0x01, 0x00, 0x05, 0x18, 0x00, 0x00, 0x00, 0x00, // INT_CTL_ENABLE
    // 0x18 = Enable PH (Packet Handler) and Preamble interrupts

    // Packet Handler Interrupt Enable - Enable preamble and sync detect
    0x05, 0x01, 0x01, 0x02, 0x30, 0x00,               // INT_CTL_PH_ENABLE
    // 0x30 = Enable preamble detect and sync detect interrupts

    // Modem Interrupt Enable - Optional, for additional modem events
    0x05, 0x01, 0x02, 0x02, 0x00, 0x00,               // INT_CTL_MODEM_ENABLE

    // Chip Interrupt Enable - Optional, for chip-level events
    0x05, 0x01, 0x03, 0x02, 0x00, 0x00,               // INT_CTL_CHIP_ENABLE

    // Packet Configuration for POCSAG
    0x08, 0x12, 0x00, 0x06, 0x00, 0x00, 0x00, 0x30, 0x30, // PKT_CONFIG1
    // Configure for variable length packets, no CRC (POCSAG has its own)

    // Packet Length Configuration
    0x05, 0x12, 0x06, 0x02, 0x00, 0xFF,               // PKT_LEN
    // Maximum packet length for POCSAG messages

    // Packet Field Configuration
    0x10, 0x12, 0x08, 0x0E, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, // PKT_FIELD_1_CONFIG

    // Wake-Up Timer Configuration (optional - for periodic wake-up if no signal)
    0x05, 0x16, 0x00, 0x02, 0x00, 0x00,               // WUT_CONFIG

    // Frequency Control
    0x0B, 0x80, 0x00, 0x0A, 0x09, 0x25, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, // FREQ_CONTROL_INTE

    0x00 // End of configuration
};

// Additional commands to send after basic configuration for wake-on-radio mode
static const uint8_t WAKE_ON_RADIO_COMMANDS[] = {
    // Set RX timeout for wake-on-radio (optional)
    0x11, 0x50, 0x00, 0x02, 0x00, 0x08,              // Set RX timeout

    // Configure low power mode parameters
    0x11, 0x30, 0x00, 0x04, 0x00, 0x00, 0x01, 0x00, // Set low power oscillator

    // End marker
    0x00
};

#endif // RADIO_CONFIG_SI4463_H

